(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52648f62"],{"0c23":function(t,e,n){"use strict";n("68df")},3190:function(t,e,n){},"5f1c":function(t,e,n){"use strict";n("3190")},6239:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var o=n("d4ec"),a=n("bee2"),s=(n("e9c4"),n("d3b7"),n("5c96")),i=5e3,c=3,r=!1,l={timeout:3e4,timeoutObj:null,reset:function(){return clearInterval(this.timeoutObj),this},start:function(t,e){var n=this,o=0;t.send(e),n.timeoutObj&&clearInterval(n.timeoutObj),n.timeoutObj=setInterval((function(){1===t.socket.readyState&&(t.send(e),console.info("HeartBeat第".concat(o+1,"次"))),o++}),n.timeout),console.info("ws-start-intervalID")}},h=function(){function t(e){Object(o["a"])(this,t),this.socket=null,this.params=e,this.reconnectCount=0,this.i=0,"WebSocket"in window?this.init(e):Object(s["Message"])({message:"浏览器不支持，请换浏览器再试",type:"error"})}return Object(a["a"])(t,[{key:"init",value:function(t){var e=this;if(console.log("init方法开始"),!t.path)throw new Error("参数socket服务器地址path必须存在");this.path=t.path,console.log("🚀 ~ WebSocketClass ~ init ~ this.path:",this.path),this.socket=new WebSocket(this.path),this.socket.onopen=function(){console.log("连接开启"),e.reconnectCount=0,l.timeout=e.params.heartInterval||3e4,l.reset().start(e,e.params.userInfo)},this.socket.onclose=function(t){console.log("file: WebsocketClass.js ~ line 41 ~ WebSocketClass ~ init ~ event",t),console.log("连接关闭"),clearInterval(l.timeoutObj),console.log("ws-clear-intervalID"),[3e3].some((function(e){return e===t.code}))||e.reconnect()},this.socket.onerror=function(){console.log("连接错误")},this.socket.onmessage=t.onmessage||this.getMessage}},{key:"getMessage",value:function(t){return console.log("收到的消息",t),t}},{key:"send",value:function(t){var e=this,n=null;try{1==this.socket.readyState?(this.i=0,clearTimeout(n),this.socket.send(JSON.stringify(t))):this.i<=10?(console.log(this.socket.readyState),++this.i,n=setTimeout((function(){e.send(t)}),100*this.i)):(this.i=0,clearTimeout(n))}catch(o){console.warn("send",o)}}},{key:"close",value:function(){console.log("调用关闭"),clearTimeout(this.reconnectTimeout),this.socket.close(3e3,"手动关闭")}},{key:"reconnect",value:function(){var t=this;r||(r=!0,this.reconnectCount<c&&(this.reconnectTimeout=setTimeout((function(){console.info("正在重连第".concat(t.reconnectCount+1,"次")),t.reconnectCount++,r=!1,t.init(t.params)}),i)))}}])}()},"68df":function(t,e,n){},"7a6f":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reasoning-details-box"},[n("div",{staticStyle:{"margin-bottom":"20px","text-align":"left"}},[n("el-button",{attrs:{type:"info"}},[t._v("推理名称："+t._s(t.name))])],1),n("div",{staticClass:"bottom-big-box"},[n("div",{staticClass:"left-box"},[n("div",{staticClass:"chart-box"},[t._m(0),n("div",{staticClass:"top-chart"},[n("TwoLineChart",{ref:"lineChart1",attrs:{chartData:t.chartData1}})],1)]),n("div",{staticClass:"chart-box"},[t._m(1),n("div",{staticClass:"bottom-chart"},[n("TwoLineChart",{ref:"linchart2",attrs:{chartData:t.chartData2}})],1)])]),n("div",{staticClass:"right-box"},[n("ReasoningLog",{attrs:{name:t.name}})],1)])])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"chart-name"},[t._v("CPU使用详情")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"chart-name"},[t._v("内存使用情况")])])}],s=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"chart",staticClass:"experiment-chart"})}),i=[],c=n("ade3"),r=n("313e"),l=Object(c["a"])(Object(c["a"])({props:{chartData:{type:[Object,Array],default:function(){return{}}}},data:function(){return{}},watch:{handleSeries:{handler:function(){var t=this;this.chart?this.chart.setOption(this.getOption()):this.$nextTick((function(){t.initData()}))},immediate:!0}},created:function(){console.log,window.addEventListener("resize",this.resize)},mounted:function(){var t=this;setTimeout((function(){t.initData()}),500)},beforeDestroy:function(){window.removeEventListener("resize",this.resize),this.chart&&this.chart.dispose()}},"data",(function(){return{handleSeries:[]}})),"methods",{initData:function(){this.chart?(this.chart.clear(),this.chart=r["a"](this.$refs.chart),this.chart.setOption(this.getOption())):(this.chart=r["a"](this.$refs.chart),0!=this.handleSeries.length&&this.chart.setOption(this.getOption()))},getOption:function(){var t=this.chartData.legendData,e=this.chartData.xData,n=this.chartData.yData,o=this.chartData.yName,a={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},xAxis:{name:"",boundaryGap:!1,data:e,axisLine:{show:!0,lineStyle:{color:"rgba(117, 168, 202, 0.4)"},symbol:["none","arrow"],symbolSize:[7,10],symbolOffset:[0,8]},axisTick:{show:!1},axisLabel:{color:"rgba(0, 0, 0, 0.8)"}},yAxis:[{name:o,type:"value",inverse:!1,splitLine:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.2)",type:"dashed"}},axisLine:{show:!0,lineStyle:{color:"rgba(117, 168, 202, 0.4)"},symbol:["none","arrow"],symbolSize:[7,10],symbolOffset:[0,8]},axisLabel:{formatter:"{value}",textStyle:{color:"rgba(0, 0, 0, 0.8)",fontSize:12}},nameTextStyle:{color:"rgba(0, 0, 0, 0.8)",padding:[0,0,0,15],fontSize:14},axisTick:{show:!1}}],series:[{name:t[0],type:"line",symbol:"circle",showAllSymbol:!0,symbolSize:0,smooth:!1,itemStyle:{normal:{color:"#d8acd8",lineStyle:{color:"#66c959",width:1}}},data:n}]};return console.log("🚀 ~ getOption ~ option:",a),a},resize:function(){this.chart.setOption(this.getOption()),this.chart.resize()}}),h=l,u=(n("5f1c"),n("2877")),f=Object(u["a"])(h,s,i,!1,null,null,null),d=f.exports,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"messageBox",staticClass:"experiment-log-box",attrs:{id:"message-big-box"}},t._l(t.data,(function(e,o){return n("div",{key:o,staticClass:"box-card"},[t._v(" "+t._s(e)+" ")])})),0)},g=[],b=(n("99af"),n("6239")),p={props:{name:{type:String,default:function(){return"test-structured-data"}}},data:function(){return{data:[],ws:null,shouldScrollToBottom:!0}},created:function(){this.init()},mounted:function(){this.addScrollListener()},beforeDestroy:function(){this.ws.close(),console.log("关闭消息推送"),this.removeScrollListener(),this.data=[]},methods:{init:function(){this.ws=new b["a"]({path:"".concat(window.g.wsUrl1,"?endpointName=").concat(this.name),userInfo:1001,onmessage:this.onmessage})},onmessage:function(t){this.data.push(t.data),this.shouldScrollToBottom&&this.scrollToBottom(),this.data.length>500&&this.data.shift()},suggest:function(){this.dialogVisible=!0},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))},handleWebSocketOpen:function(){console.log("WebSocket connection opened")},handleWebSocketError:function(t){console.error("WebSocket error:",t)},handleWebSocketClose:function(){console.log("WebSocket connection closed")},addScrollListener:function(){this.$refs.messageBox.addEventListener("scroll",this.handleScroll)},removeScrollListener:function(){this.$refs.messageBox.removeEventListener("scroll",this.handleScroll)},handleScroll:function(t){var e=t.target,n=e.scrollTop,o=e.clientHeight,a=e.scrollHeight;this.shouldScrollToBottom=n+o>=a-110},scrollToBottom:function(){var t=this;this.$nextTick((function(){t.$refs.messageBox.scrollTop=t.$refs.messageBox.scrollHeight}))}}},v=p,y=(n("0c23"),Object(u["a"])(v,m,g,!1,null,null,null)),x=y.exports,S=n("2aab"),w={components:{TwoLineChart:d,ReasoningLog:x},props:{experiment_job_name:{type:String,default:""}},data:function(){return{name:"",chartData1:{legendData:["CPU使用详情"],yName:"cpu-usage/m",xData:[],yData:[]},chartData2:{legendData:["内存使用情况"],yName:"memory-rss/Mi",xData:[],yData:[]}}},watch:{},created:function(){this.init()},methods:{init:function(){this.name=this.$route.query.name,this.getData()},getData:function(){var t=this,e=this.name+"/metrics";Object(S["e"])(e).then((function(e){console.log(e,"实验监测"),t.chartData1.xData=e.data.metrics.cpuUsage.xaxis,t.chartData1.yData=e.data.metrics.cpuUsage.yaxis,t.chartData2.xData=e.data.metrics.memoryRss.xaxis,t.chartData2.yData=e.data.metrics.memoryRss.yaxis,t.$refs.lineChart1.initData(),t.$refs.linchart2.initData()}))}}},D=w,k=(n("cc92"),Object(u["a"])(D,o,a,!1,null,null,null));e["default"]=k.exports},cc92:function(t,e,n){"use strict";n("e0d5")},e0d5:function(t,e,n){}}]);